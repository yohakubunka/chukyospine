<% const langLabelMap = { ja: 'JP', en: 'EN', zh: 'TW' }; %>
    <% const langLabel = langLabelMap[lang] || 'JP'; %>

        <div class="lang-switcher">
            <div class="lang-switcher_box">
                <img class="lang-switcher_icon" src="/images/language.svg" alt="" aria-hidden="true" />
                <span class="lang-switcher_value"><%= langLabel %></span>
                <img class="lang-switcher_arrow" src="/images/bottom-arrow.svg" alt="" aria-hidden="true" />
                <select id="lang-select" class="lang-switcher_select" name="lang" data-current-lang="<%= lang %>" aria-label="Language">
      <option value="ja" <%= lang === 'ja' ? 'selected' : '' %>>日本語</option>
      <option value="en" <%= lang === 'en' ? 'selected' : '' %>>English</option>
      <option value="zh" <%= lang === 'zh' ? 'selected' : '' %>>中文</option>
    </select>
            </div>
        </div>
        <script>
            (function() {
                const select = document.getElementById('lang-select');
                if (!select) return;

                // 現在の言語を選択状態にセット
                const currentLang = select.dataset.currentLang || 'ja';
                select.value = currentLang;

                // 言語切り替え：同じパスのまま言語プレフィックスを変更
                select.addEventListener('change', (event) => {
                    const lang = event.target.value;
                    const basePath =
                        window.location.pathname.replace(/^\/(ja|en|zh)(?=\/|$)/, '') || '/';
                    const nextPath = lang === 'ja' ? basePath : `/${lang}${basePath}`;
                    window.location.href = nextPath;
                });
            })();
        </script>